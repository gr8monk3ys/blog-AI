<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog AI</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="popup-container">
    <!-- Header -->
    <header class="popup-header">
      <div class="logo-section">
        <img src="../icons/icon32.png" alt="Blog AI" class="logo" aria-hidden="true">
        <h1>Blog AI</h1>
      </div>
      <button
        id="settings-btn"
        class="icon-btn"
        aria-label="Open settings"
        title="Settings"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
        </svg>
      </button>
    </header>

    <!-- Connection Status -->
    <div id="connection-status" class="status-bar" role="status" aria-live="polite">
      <span class="status-indicator" aria-hidden="true"></span>
      <span class="status-text">Checking connection...</span>
    </div>

    <!-- Auth Section (shown when not connected) -->
    <section id="auth-section" class="section hidden" aria-labelledby="auth-heading">
      <h2 id="auth-heading" class="visually-hidden">Authentication</h2>
      <div class="form-group">
        <label for="api-key-input">API Key</label>
        <div class="input-group">
          <input
            type="password"
            id="api-key-input"
            placeholder="Enter your Blog AI API key"
            autocomplete="off"
            aria-describedby="api-key-help"
          >
          <button
            id="toggle-key-visibility"
            class="icon-btn"
            aria-label="Show API key"
            type="button"
          >
            <svg id="eye-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
          </button>
        </div>
        <p id="api-key-help" class="help-text">
          Get your API key from your <a href="https://blogai.com/dashboard" target="_blank" rel="noopener noreferrer">Blog AI Dashboard</a>
        </p>
      </div>
      <button id="connect-btn" class="btn btn-primary" type="button">
        Connect
      </button>
    </section>

    <!-- Main Content (shown when connected) -->
    <main id="main-section" class="section hidden">
      <!-- Quick Generate Form -->
      <form id="generate-form" aria-labelledby="generate-heading">
        <h2 id="generate-heading" class="section-title">Quick Generate</h2>

        <div class="form-group">
          <label for="topic-input">Topic or Selected Text</label>
          <textarea
            id="topic-input"
            placeholder="Enter a topic or highlight text on any page"
            rows="3"
            aria-describedby="topic-help"
          ></textarea>
          <p id="topic-help" class="help-text">
            Tip: Highlight text on any webpage and click "Use Selection"
          </p>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tone-select">Tone</label>
            <select id="tone-select" aria-describedby="tone-help">
              <option value="professional">Professional</option>
              <option value="casual">Casual</option>
              <option value="formal">Formal</option>
              <option value="friendly">Friendly</option>
              <option value="authoritative">Authoritative</option>
              <option value="conversational">Conversational</option>
            </select>
          </div>
          <div class="form-group">
            <label for="length-select">Length</label>
            <select id="length-select" aria-describedby="length-help">
              <option value="short">Short (~500 words)</option>
              <option value="medium" selected>Medium (~1000 words)</option>
              <option value="long">Long (~2000 words)</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="provider-select">Provider</label>
          <select id="provider-select">
            <option value="openai">OpenAI</option>
            <option value="anthropic">Anthropic</option>
            <option value="gemini">Gemini</option>
          </select>
          <p class="help-text">Choose which model provider to use</p>
        </div>

        <div class="form-group">
          <label for="keywords-input">Keywords (optional)</label>
          <input
            type="text"
            id="keywords-input"
            placeholder="AI, technology, innovation"
            aria-describedby="keywords-help"
          >
          <p id="keywords-help" class="help-text">Comma-separated keywords for SEO</p>
        </div>

        <div class="checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="research-checkbox">
            <span>Include web research</span>
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="proofread-checkbox" checked>
            <span>Proofread content</span>
          </label>
        </div>

        <div class="btn-group">
          <button type="button" id="use-selection-btn" class="btn btn-secondary">
            Use Selection
          </button>
          <button type="submit" id="generate-btn" class="btn btn-primary">
            Generate
          </button>
        </div>
      </form>

      <!-- Generation Progress -->
      <div id="progress-section" class="section hidden" role="status" aria-live="polite">
        <div class="progress-container">
          <div class="spinner" aria-hidden="true"></div>
          <p id="progress-text">Generating content...</p>
        </div>
      </div>

      <!-- Recent Generations -->
      <section id="recent-section" aria-labelledby="recent-heading">
        <h2 id="recent-heading" class="section-title">Recent Generations</h2>
        <ul id="recent-list" class="recent-list" role="list">
          <!-- Populated dynamically -->
        </ul>
        <p id="no-recent" class="empty-state">No recent generations</p>
      </section>
    </main>

    <!-- Footer -->
    <footer class="popup-footer">
      <a href="https://blogai.com/dashboard" target="_blank" rel="noopener noreferrer" class="footer-link">
        Open Dashboard
      </a>
      <span class="divider" aria-hidden="true">|</span>
      <a href="https://docs.blogai.com" target="_blank" rel="noopener noreferrer" class="footer-link">
        Documentation
      </a>
    </footer>
  </div>

  <!-- Error Toast -->
  <div id="toast" class="toast hidden" role="alert" aria-live="assertive">
    <span id="toast-message"></span>
    <button id="toast-close" class="toast-close" aria-label="Close notification">&times;</button>
  </div>

  <script src="../lib/api.js"></script>
  <script src="popup.js"></script>
</body>
</html>
